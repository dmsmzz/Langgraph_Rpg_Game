# 🎮 명성 시스템 적용 LangGraph RPG

> LangGraph와 LangChain을 활용한 명성 시스템 기반 텍스트 RPG 게임

## 🌟 주요 특징

### 🏆 명성 시스템 (Reputation System)
- **동적 NPC 반응**: 명성에 따라 NPC 태도가 실시간으로 변화
- **가격 조정**: 명성이 높을수록 할인, 낮을수록 할증
- **동료 영입**: 명성에 따른 동료 품질 및 영입 난이도 차이
- **8단계 명성 레벨**: 영웅 → 원수까지 세분화된 반응

### 🎯 게임 시스템
- **동적 스토리**: AI가 실시간으로 생성하는 스토리
- **전투 시스템**: 파티 기반 전투 및 명성 반영 적 반응
- **인벤토리 관리**: 아이템 수집, 사용, 관리 시스템
- **상점 시스템**: 명성 기반 동적 가격 조정
- **동료 시스템**: 최대 3명 파티 구성 가능

### 🏗️ 기술 스택
- **LangGraph**: 워크플로우 관리 및 상태 기반 게임 진행
- **LangChain**: AI 모델 연동 및 프롬프트 관리
- **OpenAI GPT-4o-mini**: 동적 스토리 및 대화 생성
- **SQLite**: 게임 데이터 영구 저장
- **Python**: 모듈화된 객체지향 설계

## 📁 프로젝트 구조

```
rpg-game/
├── models.py              # 데이터 모델 및 타입 정의
├── reputation_system.py   # 명성 시스템 관리
├── database.py            # 데이터베이스 관리
├── story_manager.py       # 스토리 컨텍스트 관리
├── battle_system.py       # 전투 시스템
├── inventory_system.py    # 인벤토리 및 상점 시스템
├── game_nodes.py          # 게임 노드 구현
├── game_graph.py          # LangGraph 워크플로우
├── main.py                # 메인 실행 파일
├── requirements.txt       # 필요한 라이브러리
└── README.md             # 프로젝트 설명서

## 🚀 설치 및 실행

### 1. 환경 설정
```bash
# 가상환경 생성
python -m venv venv

# 가상환경 활성화 (Windows)
venv\Scripts\activate

# 가상환경 활성화 (Linux/Mac)
source venv/bin/activate

# 필요한 라이브러리 설치
pip install -r requirements.txt
```

### 2. OpenAI API 키 설정
# 2-1 env 생성
```bash
# .env 파일 생성
echo "OPENAI_API_KEY=your_api_key_here" > .env
```
# 2-2 게임 실행 후, API 키 직접 입력
'''
OpenAI API 키를 입력하세요 (sk-로 시작):
'''

### 3. 게임 실행
```bash
python main.py
```

## 🎮 게임 플레이 가이드

### 기본 명령어
- `명성 확인` - 현재 명성 상태 및 효과 확인
- `인벤토리` - 아이템 관리 및 사용
- `물약 구입` - 상점에서 아이템 구매
- `물약 사용` - HP/MP 회복
- `힐 사용` - 성직자의 치유 마법

### 명성 시스템 이해
#### 명성 레벨별 효과
- **영웅 (80+)**: 극도로 존경받음, 50% 할인, 무료 서비스
- **매우 호의적 (60-79)**: 매우 친근함, 30% 할인, 추가 정보
- **호의적 (20-59)**: 친근함, 10% 할인, 기본 협조
- **평범 (0-19)**: 중립적, 정상 가격, 기본 서비스
- **약간 비호의적 (-1~-20)**: 경계함, 20% 할증, 정보 제한
- **적대적 (-21~-40)**: 불쾌함, 50% 할증, 무례한 태도
- **매우 적대적 (-41~-60)**: 두려워함, 100% 할증, 서비스 거부
- **원수 (-61 이하)**: 극도로 적대적, 300% 할증, 전투 또는 도망

#### 명성 변화 요인
**명성 상승 행동**
- 퀘스트 완료 (+10)
- 생명 구조 (+15)
- 마을 구원 (+25)
- 보스 처치 (+20)
- 동료 영입 (+3~5)

**명성 하락 행동**
- 동료 배신 (-30)
- 민간인 공격 (-40)
- 도둑질 (-15)
- 거짓말 (-5)
- 약속 위반 (-10)

### 게임 플레이 팁
1. **명성 관리**: 초기에는 선한 행동으로 명성을 쌓는 것이 유리
2. **파티 구성**: 최대 3명까지 파티 구성 가능 (플레이어 + 동료 2명)
3. **자원 관리**: 골드와 아이템을 효율적으로 관리
4. **상점 활용**: 명성이 높을 때 필요한 아이템을 대량 구매

### 주요 클래스
- `ReputationManager`: 명성 시스템 관리
- `BattleSystem`: 전투 로직 처리
- `InventorySystem`: 인벤토리 관리
- `ShopSystem`: 상점 거래 처리
- `StoryManager`: 스토리 컨텍스트 관리
- `GameNodes`: 게임 노드 구현

### 데이터베이스 스키마
- `main_story_characters`: 캐릭터 정보
- `inventory`: 인벤토리 아이템
- `story_events`: 스토리 이벤트 기록
- `reputation_changes`: 명성 변화 기록
- `shop_transactions`: 상점 거래 기록

## 🎯 향후 개발 계획
1. 서브 스토리 및 퀘스트 시스템 개발
2. 단순한 배틀씬 구현 방식에서 턴제 배틀씬 구현으로 변화
3. 메인 스토리 결말이 없는 상태이므로 결말 완성
4. 초기 구상에서 모든 시스템을 LLM으로 판단하여 처리하도록 하려고 했으나
불안정성 및 비용 문제로 각 노드에서의 처리 수준에 따라 모델의 수준을 낮추거나
키워드 하드코딩 및 Kobert와 같은 자체 학습 LLM으로 처리하는 방안 구상

### 개발 환경 설정
```bash
# 개발용 의존성 설치
pip install -r requirements.txt